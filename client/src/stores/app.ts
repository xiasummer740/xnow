import { defineStore } from 'pinia';
const i18nDict = {
  zh: { console: 'æŽ§åˆ¶å°', balance: 'ä½™é¢', logout: 'é€€å‡ºç™»å½•', menu_order: 'å¼€å§‹ä¸‹å•', menu_mass: 'æ‰¹é‡ä¸‹å•', menu_history: 'åŽ†å²è®¢å•', menu_recharge: 'å¤§ä½¬å……å€¼', menu_vip: 'è‡³å°Šä»£ç†', menu_admin: 'ç®¡ç†å¯†å®¤', menu_api: 'å¼€å‘è€… API', search_placeholder: 'æœç´¢è®¢å•å· / é“¾æŽ¥...', sys_notice: 'ç³»ç»Ÿå…¬å‘Š', category: 'æœåŠ¡åˆ†ç±» (Category)', service: 'å…·ä½“æœåŠ¡é¡¹ç›® (Service)', link: 'ç›®æ ‡é“¾æŽ¥ (Link)', quantity: 'ä¸‹å•æ•°é‡', total_price: 'é¢„ä¼°é‡‘é¢', submit_order: 'ç«‹å³æäº¤è®¢å•', waiting_data: 'ç­‰å¾…ä¸Šæ¸¸æ•°æ®åŒæ­¥...', select_cat_first: 'è¯·å…ˆé€‰æ‹©åˆ†ç±»', guide_title: 'ðŸ’¡ ä¸‹å•è§„èŒƒæŒ‡å—', guide_1: 'âš ï¸ 1. è®¢å•å®Œæˆå‰åˆ‡å‹¿é‡å¤ä¸‹å•ã€‚', guide_2: 'âš ï¸ 2. ç¡®ä¿è´¦å·ä¸ºå…¬å¼€çŠ¶æ€ã€‚', recharge_title: 'èµ„é‡‘å……å€¼', recharge_desc: 'å®‰å…¨ã€å³æ—¶åˆ°è´¦çš„èšåˆæ”¯ä»˜æ”¶é“¶å°', select_pay: 'é€‰æ‹©æ”¯ä»˜æ–¹å¼', recharge_amount: 'å……å€¼é‡‘é¢', actual_pay: 'åº”ä»˜é‡‘é¢', actual_get: 'å®žé™…åˆ°è´¦', pay_btn: 'ç«‹å³å®‰å…¨æ”¯ä»˜', wechat: 'å¾®ä¿¡æ”¯ä»˜', alipay: 'æ”¯ä»˜å®', usdt: 'USDT (TRC20)', rmb_desc_title: 'â„¹ï¸ RMB å……å€¼è¯´æ˜Ž', rmb_desc_1: 'å»ºè®®å……å€¼é‡‘é¢ä¸º 5 çš„æ•´æ•°å€ã€‚å¾®ä¿¡/æ”¯ä»˜å®æ”¯ä»˜éœ€è¦é¢å¤– ', rmb_desc_2: '5%', rmb_desc_3: ' çš„é€šé“è´¹ã€', rmb_desc_4: 'å•æ¬¡å……å€¼500å…ƒä»¥ä¸Šä¼šèµ é€5%ï¼Œç›¸å½“äºŽå‡å…æ‰‹ç»­è´¹', rmb_desc_5: 'ã€‘ã€‚', rmb_tip: 'ðŸ’¡ Tip: å……å€¼ 500+ å…æ‰‹ç»­è´¹', usd_desc_title: 'âš¡ USDT çœé’±æ”»ç•¥', usd_desc_1: 'USDT å……å€¼ä¸ä»… ', usd_desc_2: 'å…åŽ»æ‰€æœ‰é€šé“è´¹', usd_desc_3: 'ï¼Œè¿˜å¯ä½¿ç”¨èƒ½é‡ç§ŸèµèŠ‚çœæ‰“å¸æ‰‹ç»­è´¹ï¼', usd_btn: 'TRX èƒ½é‡ç§Ÿèµå¹³å° ðŸ‘‰ ç‚¹å‡»è¿›å…¥', 
  super_admin_badge: 'è¶…çº§ç³»ç»Ÿç®¡ç†', admin_badge: 'è‡³å°Šç®¡ç†å‘˜', agent_badge: 'è‡³å°Šä»£ç†', gold_badge: 'é»„é‡‘ç”¨æˆ·', 
  vip_title: 'å‡çº§è‡³å°Šä»£ç† Â· æŽŒæŽ§å…¨å±€åˆ©æ¶¦', vip_subtitle: 'ä¸ä»…æ˜¯å…¨ç½‘é™ç»´æ‰“å‡»çš„æ‰¹å‘åº•ä»·ï¼Œæ›´èƒ½é€šè¿‡ä¸“å±ž API ä¸€é”®æ­å»ºæ‚¨çš„ç‹¬ç«‹å•†ä¸šå¸å›½ã€‚', vip_feature1_title: 'ðŸ“‰ æ–­å´–å¼å…¨å±€åº•ä»·', vip_feature1_desc: 'è¶Šè¿‡æ‰€æœ‰ä¸­é—´å•†ï¼å°Šäº«å…¨ç«™æœåŠ¡æŒ‡å¯¼ä»· 20%~50% çš„ç»ˆæžåº•ä»·ç»“ç®—ï¼Œå°†æœ€å¤§åŒ–çš„åˆ©æ¶¦ç©ºé—´å…¨é‡é‡Šæ”¾ç»™æ‚¨ã€‚', vip_feature2_title: 'ðŸ”Œ API æ— ç¼ç‹¬ç«‹å»ºç«™', vip_feature2_desc: 'å…¨é¢å¼€æ”¾å¼€å‘è€… APIï¼Œæ”¯æŒå®Œç¾Žå¯¹æŽ¥å¸‚é¢æ‰€æœ‰ä¸»æµ SMM é¢æ¿ã€‚ä¸€é”®å…‹éš†å…¨ç«™è´§æºï¼Œè½»æ¾åšçœŸæ­£çš„å¹³å°ä¸»ç†äººã€‚', vip_feature3_title: 'âš¡ ä¸“å±žç ”å‘çº§ä¿éšœ', vip_feature3_desc: '7x24å°æ—¶ä¼˜å…ˆå“åº”å”®åŽé€šé“ï¼Œè®¢å•å¼‚å¸¸ç§’é€€ç§’è¡¥ï¼Œç”±é¡¶çº§æŠ€æœ¯å›¢é˜Ÿä¸ºæ‚¨çš„æµ·é‡å¹¶å‘ä¸šåŠ¡ä¿é©¾æŠ¤èˆªã€‚', vip_status_admin: 'æ‚¨å·²æ˜¯æœ€é«˜æƒé™ç®¡ç†å‘˜ï¼Œäº«æœ‰ä¸Šå¸è§†è§’ï¼Œæ— éœ€å¼€é€šä»£ç†ã€‚', vip_status_active: 'å°Šè´µçš„ã€è‡³å°Šä»£ç†ã€‘ç‰¹æƒå·²æ¿€æ´»', vip_expire: 'ä»£ç†æœ‰æ•ˆæœŸè‡³ï¼š', vip_btn_renew: 'ç«‹å³ç»­è´¹ç‰¹æƒ (Â¥ 99 / 30å¤©)', vip_btn_upgrade: 'ç«‹å³è§£é”è‡³å°Šä»£ç† (Â¥ 99 / 30å¤©)' },
  en: { console: 'Console', balance: 'Balance', logout: 'Logout', menu_order: 'New Order', menu_mass: 'Mass Order', menu_history: 'Order History', menu_recharge: 'Add Funds', menu_vip: 'VIP Agent', menu_admin: 'Admin Panel', menu_api: 'Developer API', search_placeholder: 'Search...', sys_notice: 'Announcement', category: 'Category', service: 'Service', link: 'Target Link', quantity: 'Quantity', total_price: 'Total Price', submit_order: 'Submit Order', waiting_data: 'Waiting for sync...', select_cat_first: 'Select a category first', guide_title: 'ðŸ’¡ Order Guidelines', guide_1: 'âš ï¸ 1. Do not place same link twice before completion.', guide_2: 'âš ï¸ 2. Ensure account is public.', recharge_title: 'Add Funds', recharge_desc: 'Secure & Instant Payment Gateway', select_pay: 'Select Payment Method', recharge_amount: 'Amount', actual_pay: 'You Pay', actual_get: 'You Get', pay_btn: 'Pay Securely', wechat: 'WeChat Pay', alipay: 'Alipay', usdt: 'USDT (TRC20)', rmb_desc_title: 'â„¹ï¸ RMB Notice', rmb_desc_1: '5% extra fee applies to WeChat/Alipay. ', rmb_desc_2: '5%', rmb_desc_3: ' fee waived for ', rmb_desc_4: 'deposits over 500 CNY', rmb_desc_5: '.', rmb_tip: 'ðŸ’¡ Tip: Deposit 500+ to waive fees', usd_desc_title: 'âš¡ USDT Savings', usd_desc_1: 'USDT deposits have ', usd_desc_2: 'ZERO channel fees!', usd_desc_3: ' Use energy rental to save on TRX gas.', usd_btn: 'TRX Energy Rental ðŸ‘‰ Click Here', 
  super_admin_badge: 'Super Admin', admin_badge: 'Supreme Admin', agent_badge: 'VIP Agent', gold_badge: 'Gold User', 
  vip_title: 'Upgrade to VIP Agent', vip_subtitle: 'Unlock wholesale prices and easily build your own SMM panel with our seamless API.', vip_feature1_title: 'ðŸ“‰ Ultimate Wholesale Price', vip_feature1_desc: 'Bypass the middlemen! Enjoy 20%~50% off the standard retail price. Maximize your profit margins.', vip_feature2_title: 'ðŸ”Œ API Reseller Panel', vip_feature2_desc: 'Full access to our Developer API. Sync our entire service list to your own SMM panel and become a platform owner.', vip_feature3_title: 'âš¡ Priority Tech Support', vip_feature3_desc: '24/7 dedicated support channel. Auto-refills and instant refunds for absolute peace of mind.', vip_status_admin: 'You have Supreme Admin privileges. No need to upgrade.', vip_status_active: 'VIP Agent Status: ACTIVE', vip_expire: 'Expires on: ', vip_btn_renew: 'Renew VIP Status (Â¥ 99 / 30 Days)', vip_btn_upgrade: 'Unlock VIP Agent (Â¥ 99 / 30 Days)' }
};
export const useAppStore = defineStore('app', {
  state: () => ({ currency: 'CNY', lang: 'zh', exchangeRate: 7.25, siteName: 'XNOW', siteLogo: '/logo.png', tgBotLink: 'https://t.me/Xnow001Bot', globalRefreshTrigger: 0 }),
  actions: {
    toggleCurrency() { this.currency = this.currency === 'CNY' ? 'USD' : 'CNY'; }, toggleLang() { this.lang = this.lang === 'zh' ? 'en' : 'zh'; }, triggerRefresh() { this.globalRefreshTrigger++; }, 
    async fetchRate() { try { const resRate = await fetch('https://open.er-api.com/v6/latest/USD'); const dataRate = await resRate.json(); if(dataRate && dataRate.rates && dataRate.rates.CNY) this.exchangeRate = dataRate.rates.CNY; } catch(e) {} },
    async fetchConfig() { try { const res = await fetch('/api/public/config'); const data = await res.json(); if(data && data.status === 'success') { if (data.data.site_name) this.siteName = data.data.site_name; if (data.data.site_logo) this.siteLogo = data.data.site_logo; if (data.data.tg_bot_link) this.tgBotLink = data.data.tg_bot_link; } } catch(e) {} this.fetchRate(); },
    t(key) { return i18nDict[this.lang][key] || key; }, 
    formatMoney(cnyAmount) { const amt = parseFloat(cnyAmount || 0); if (this.currency === 'CNY') return `Â¥ ${(amt).toFixed(2)}`; return `$ ${(amt / this.exchangeRate).toFixed(4)}`; }
  }
});
